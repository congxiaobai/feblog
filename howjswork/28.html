<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>è‘±ç™½çš„å·¥å…·ç®±</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Hello World">
    
    <link rel="preload" href="/feblog/assets/css/0.styles.90641447.css" as="style"><link rel="preload" href="/feblog/assets/js/app.af16a26a.js" as="script"><link rel="preload" href="/feblog/assets/js/2.bb248851.js" as="script"><link rel="preload" href="/feblog/assets/js/31.3494180c.js" as="script"><link rel="prefetch" href="/feblog/assets/js/10.1e7b7348.js"><link rel="prefetch" href="/feblog/assets/js/11.5df11de0.js"><link rel="prefetch" href="/feblog/assets/js/12.0cb13daa.js"><link rel="prefetch" href="/feblog/assets/js/13.b7203228.js"><link rel="prefetch" href="/feblog/assets/js/14.0d1b8841.js"><link rel="prefetch" href="/feblog/assets/js/15.40482005.js"><link rel="prefetch" href="/feblog/assets/js/16.975967de.js"><link rel="prefetch" href="/feblog/assets/js/17.80e3a75b.js"><link rel="prefetch" href="/feblog/assets/js/18.f8871089.js"><link rel="prefetch" href="/feblog/assets/js/19.9ccf9155.js"><link rel="prefetch" href="/feblog/assets/js/20.4f05958f.js"><link rel="prefetch" href="/feblog/assets/js/21.2532e6ba.js"><link rel="prefetch" href="/feblog/assets/js/22.10fa876d.js"><link rel="prefetch" href="/feblog/assets/js/23.9adf1998.js"><link rel="prefetch" href="/feblog/assets/js/24.8d4a2693.js"><link rel="prefetch" href="/feblog/assets/js/25.db370b93.js"><link rel="prefetch" href="/feblog/assets/js/26.f32df43c.js"><link rel="prefetch" href="/feblog/assets/js/27.15cd01b9.js"><link rel="prefetch" href="/feblog/assets/js/28.6a8a79bd.js"><link rel="prefetch" href="/feblog/assets/js/29.3b89a9ef.js"><link rel="prefetch" href="/feblog/assets/js/3.bd55a964.js"><link rel="prefetch" href="/feblog/assets/js/30.921b4f31.js"><link rel="prefetch" href="/feblog/assets/js/32.50330ec3.js"><link rel="prefetch" href="/feblog/assets/js/33.f0880d8a.js"><link rel="prefetch" href="/feblog/assets/js/34.e0057bb1.js"><link rel="prefetch" href="/feblog/assets/js/35.7703da2a.js"><link rel="prefetch" href="/feblog/assets/js/36.faf60c12.js"><link rel="prefetch" href="/feblog/assets/js/37.405fda0a.js"><link rel="prefetch" href="/feblog/assets/js/38.1e542b1a.js"><link rel="prefetch" href="/feblog/assets/js/39.64acf374.js"><link rel="prefetch" href="/feblog/assets/js/4.719e49fe.js"><link rel="prefetch" href="/feblog/assets/js/5.b7269ca1.js"><link rel="prefetch" href="/feblog/assets/js/6.004ca1a2.js"><link rel="prefetch" href="/feblog/assets/js/7.0bb92c79.js"><link rel="prefetch" href="/feblog/assets/js/8.e350d733.js"><link rel="prefetch" href="/feblog/assets/js/9.bd5a10e4.js">
    <link rel="stylesheet" href="/feblog/assets/css/0.styles.90641447.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/feblog/" class="home-link router-link-active"><!----> <span class="site-name">è‘±ç™½çš„å·¥å…·ç®±</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/feblog/" class="nav-link">
  Codingé›†
</a></div><div class="nav-item"><a href="/feblog/book/" class="nav-link">
  æŠ«æ˜Ÿé›†
</a></div><div class="nav-item"><a href="/feblog/atrcile/" class="nav-link">
  è·é”„é›†
</a></div><div class="nav-item"><a href="/feblog/han/" class="nav-link">
  é”„æœˆé›†
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/feblog/" class="nav-link">
  Codingé›†
</a></div><div class="nav-item"><a href="/feblog/book/" class="nav-link">
  æŠ«æ˜Ÿé›†
</a></div><div class="nav-item"><a href="/feblog/atrcile/" class="nav-link">
  è·é”„é›†
</a></div><div class="nav-item"><a href="/feblog/han/" class="nav-link">
  é”„æœˆé›†
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ä¸JSå…±èˆ</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/feblog/howjswork/1.html" class="sidebar-link">1.å¼•æ“ï¼Œè¿è¡Œæ—¶ï¼Œè°ƒç”¨æ ˆæ¦‚è¿°</a></li><li><a href="/feblog/howjswork/2.html" class="sidebar-link">2.V8 å¼•æ“ä¸­ä¹¦å†™æœ€ä¼˜ä»£ç çš„ 5 æ¡å°æŠ€å·§</a></li><li><a href="/feblog/howjswork/3.html" class="sidebar-link">3.å†…å­˜ç®¡ç†ä»¥åŠå¸¸è§çš„å†…å­˜æ³„æ¼å¤„ç†</a></li><li><a href="/feblog/howjswork/4.html" class="sidebar-link">4.Event loopå’Œå¼‚æ­¥ç¼–ç¨‹</a></li><li><a href="/feblog/howjswork/5.html" class="sidebar-link">5.WebSockets å’ŒHTTP2çš„æ­£ç¡®å§¿åŠ¿</a></li><li><a href="/feblog/howjswork/6.html" class="sidebar-link">6.WebAssemblyä»¥åŠä½¿ç”¨å®ƒçš„åœºæ™¯</a></li><li><a href="/feblog/howjswork/7.html" class="sidebar-link">7.WebWorkerå’Œ5ä¸ªä½¿ç”¨åœºæ™¯</a></li><li><a href="/feblog/howjswork/8.html" class="sidebar-link">8.Service Workers çš„ç”Ÿå‘½å‘¨æœŸå’Œä½¿ç”¨åœºæ™¯</a></li><li><a href="/feblog/howjswork/9.html" class="sidebar-link">9.ç½‘é¡µæ¨é€æœºåˆ¶</a></li><li><a href="/feblog/howjswork/10.html" class="sidebar-link">10.ä½¿ç”¨MutationObserver è·Ÿè¸ª DOM å˜åŒ–</a></li><li><a href="/feblog/howjswork/11.html" class="sidebar-link">11.æ¸²æŸ“å¼•æ“ä»¥åŠæ€§èƒ½ä¼˜åŒ–å»ºè®®</a></li><li><a href="/feblog/howjswork/12.html" class="sidebar-link">12.ç½‘ç»œå±‚å†…éƒ¨ï¼Œä»¥åŠæ€§èƒ½ï¼Œå®‰å…¨æ€§çš„ä¼˜åŒ–</a></li><li><a href="/feblog/howjswork/13.html" class="sidebar-link">13.CSSå’ŒJSåŠ¨ç”»ä»¥åŠä¼˜åŒ–å»ºè®®</a></li><li><a href="/feblog/howjswork/14.html" class="sidebar-link">14.ASTå’Œä¼˜åŒ–å»ºè®®</a></li><li><a href="/feblog/howjswork/15.html" class="sidebar-link">15.ç±»ï¼Œç»§æ‰¿ï¼ŒBabelå’ŒTSçš„è½¬æ¢</a></li><li><a href="/feblog/howjswork/16.html" class="sidebar-link">16.å­˜å‚¨å¼•æ“ä»¥åŠä½¿ç”¨åœºæ™¯</a></li><li><a href="/feblog/howjswork/17.html" class="sidebar-link">17.å½±å­DOM å†…éƒ¨æ„é€ åŠå¦‚ä½•æ„å»ºç‹¬ç«‹ç»„ä»¶</a></li><li><a href="/feblog/howjswork/18.html" class="sidebar-link">18.WebRTC åŠç‚¹å¯¹ç‚¹ç½‘ç»œé€šä¿¡æœºåˆ¶</a></li><li><a href="/feblog/howjswork/19.html" class="sidebar-link">19.è‡ªå®šä¹‰å…ƒç´ æœºåˆ¶</a></li><li><a href="/feblog/howjswork/20.html" class="sidebar-link">20.JSçš„å¼‚å¸¸å¤„ç†ä»¥åŠåœ¨å¼‚æ­¥ä¸­å¤„ç†å¼‚å¸¸çš„åŠæ³•</a></li><li><a href="/feblog/howjswork/21.html" class="sidebar-link">21.XSSçš„5ç§æ–¹å¼å’Œé˜²èŒƒç­–ç•¥</a></li><li><a href="/feblog/howjswork/22.html" class="sidebar-link">22.CRFSæ”»å‡»ä»¥åŠ7ç§é˜²èŒƒç­–ç•¥</a></li><li><a href="/feblog/howjswork/23.html" class="sidebar-link">23.è¿­ä»£å™¨ä»¥åŠå¦‚ä½•è·å¾—æ¯”generatoræ›´é«˜çš„æ§åˆ¶æƒ</a></li><li><a href="/feblog/howjswork/24.html" class="sidebar-link">24.åŠ å¯†å’Œä¸­é—´äººï¼ˆMITMï¼‰æ”»å‡»</a></li><li><a href="/feblog/howjswork/25.html" class="sidebar-link">25.å‡½æ•°å¼ç¼–ç¨‹å’ŒåŸºæœ¬æ¦‚å¿µ</a></li><li><a href="/feblog/howjswork/26.html" class="sidebar-link">26.å¤šæ€çš„3ç§ç±»å‹</a></li><li><a href="/feblog/howjswork/28.html" aria-current="page" class="active sidebar-link">28.Deno ä¸€ç¥</a></li><li><a href="/feblog/howjswork/29.html" class="sidebar-link">29.JSè®¾è®¡æ¨¡å¼</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>æœ¬æ–‡é˜…è¯»æŒ‡æ•°:3<br>
Denoå‡ºæ¥ä¸€æ®µæ—¶é—´äº†ï¼Œä¹‹å‰äº†è§£çš„å¹¶ä¸å¤šã€‚æœ¬æ–‡ç®—æ˜¯ç§‘æ™®æ€§è´¨ï¼Œæä¾›äº†ä¸€äº›ç‚¹ï¼Œéƒ½æ˜¯æ—¥å¸¸åšæŠ€æœ¯é€‰æ‹©å…³æ³¨çš„ç‚¹ã€‚å¯ä»¥ä¸€è¯»</p></blockquote> <h1 id="æ€»è§ˆ"><a href="#æ€»è§ˆ" class="header-anchor">#</a> æ€»è§ˆ</h1> <p>Denoæ˜¯ä¸€ä¸ªJSå’ŒTSçš„å®‰å…¨è¿è¡Œæ—¶ã€‚è¿™ä¸€ç« ç®€å•ä»‹ç»ä¸€ä¸‹Denoï¼Œè·ŸNodeçš„åŒºåˆ«ï¼Œè§£æä¸€äº›æœºåˆ¶æ¯”å¦‚æ¨¡å—ï¼ŒåŒ…ï¼Œå¼‚æ­¥ï¼ŒTSï¼Œå®‰å…¨å’Œå·¥å…·ã€‚</p> <h1 id="denoèµ·æº"><a href="#denoèµ·æº" class="header-anchor">#</a> Denoèµ·æº</h1> <p>Ryan Dahlâ€™såœ¨2018å¹´çš„JSConfEUä¸­â€œ10 Things I Regret About Node.jsâ€ä¸­å®£å¸ƒäº†Denoã€‚å¼€å‘è€…çœ‹åˆ°è‡ªå·±çš„é¡¹ç›®å—ä¼—è¶Šæ¥è¶Šå¤šï¼Œè¢«ä½¿ç”¨åœ¨å„ä¸ªåœ°æ–¹ï¼Œå¹¶ä»é¡¹ç›®çš„å¤±è¯¯ä¸­å­¦ä¹ ã€‚æ­£å¸¸çš„å¼€å‘è€…ä¼šå»æé«˜æˆ–è€…é‡æ„æºé¡¹ç›®ã€‚ä½†æ˜¯Ryan Dahlæ›´æ¿€è¿›ï¼Œä»–å®³æ€•ç ´åæ‰å…¼å®¹æ€§ã€‚</p> <p>ä½†æ˜¯Denoè¿˜æ˜¯å¾ˆå¹´è½»çš„ï¼Œ2020å¹´5è¶Šæ‰å‘å¸ƒæ­£æ˜¯ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚
å¯¹æ¯”ä¸€ä¸‹Deno å’Œ Node</p> <h1 id="deno-vs-node-js"><a href="#deno-vs-node-js" class="header-anchor">#</a> Deno vs. Node.js</h1> <p>ä¸‹é¢æ˜¯ä¸»è¦çš„åŒºåˆ«ã€‚ç¨åæˆ‘ä»¬ä¼šæ·±å…¥åˆ°æœºåˆ¶ã€‚ä½†æ˜¯ç›®å‰è¿˜æ˜¯ä»åŠŸèƒ½æ€§å’Œå¼€å‘è€…ä½“éªŒä¸Šè¯´</p> <p>#å†…ç½®åŒ…ç®¡ç† vs npm</p> <p>nodeéœ€è¦Npmæ¥åšåŒ…ç®¡ç†ã€‚Denoåˆ™ä»GOå’ŒRUSTä¸­å­¦ä¹ ï¼Œä½¿ç”¨URLè¿›è¡ŒåŒ…å¼•ç”¨ã€‚</p> <h1 id="es-modules-vs-commonjs-modules"><a href="#es-modules-vs-commonjs-modules" class="header-anchor">#</a> ES modules vs. CommonJS modules</h1> <p>Node ä½¿ç”¨CommonJS è§„èŒƒ:</p> <blockquote><p>const module = require(â€˜module-nameâ€™)</p></blockquote> <p>Deno ä½¿ç”¨æ ‡å‡†çš„ EcmaScript modules:</p> <blockquote><p>import module from â€˜https://some-repo/module-name.ts'</p></blockquote> <p>æ³¨æ„Denoéœ€è¦æ¨¡å—çš„å…¨éƒ¨åè¯ï¼ŒåŒ…æ‹¬æ‰©å±•åã€‚</p> <h1 id="åŸºäºæƒé™çš„è®¿é—®-vs-å…¨æ–‡è®¿é—®"><a href="#åŸºäºæƒé™çš„è®¿é—®-vs-å…¨æ–‡è®¿é—®" class="header-anchor">#</a> åŸºäºæƒé™çš„è®¿é—® vs. å…¨æ–‡è®¿é—®</h1> <p>Nodeå¯ä»¥å…¨æ–‡è®¿é—®ç¯å¢ƒï¼Œæ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œã€‚è¿™æ˜¯ä¸¥é‡çš„å®‰å…¨æ¼æ´ã€‚æ¶æ„çš„npmæ¨¡å—å¯ä»¥è½»æ˜“è®¿é—®è¿™äº›èµ„æºã€‚
Denoéœ€è¦æ˜ç¡®çš„æƒé™ï¼Œè¿™æ ·å°±èƒ½é™åˆ¶ä¸€äº›ä¸å¥½çš„è¡Œä¸ºã€‚</p> <h1 id="å†…ç½®tsç¼–è¯‘å™¨-vs-å¤–éƒ¨æ”¯æŒ"><a href="#å†…ç½®tsç¼–è¯‘å™¨-vs-å¤–éƒ¨æ”¯æŒ" class="header-anchor">#</a> å†…ç½®TSç¼–è¯‘å™¨ vs. å¤–éƒ¨æ”¯æŒ</h1> <p>Nodeä¸èƒ½ç›´æ¥ä½¿ç”¨YSã€‚ä½ éœ€è¦ä½¿ç”¨ä¸€äº›å¾ˆé‡çš„å·¥å…·é“¾è¿‘æœŸç¼–è¯‘</p> <p>Denoåˆ™å¤©ç”Ÿæ”¯æŒTSï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ æµç•…</p> <h1 id="promises-vs-å›è°ƒ"><a href="#promises-vs-å›è°ƒ" class="header-anchor">#</a> Promises vs. å›è°ƒ</h1> <p>Nodeä½¿ç”¨ä¸é˜»å¡çš„I/Oï¼Œç„¶åå½“I/Oæ“ä½œå®Œæˆæ—¶ï¼Œéœ€è¦ç”¨å›è°ƒæ¥å¤„ç†é€šçŸ¥</p> <p>Denoåˆ™ä½¿ç”¨async/await æ¨¡å¼ï¼Œéšè—äº†å›è°ƒé“¾çš„å¤æ‚æ€§ï¼Œç„¶ä»£ç æ›´å¹²å‡€ã€‚</p> <h1 id="å¼‚å¸¸æ­»äº¡-vs-æœªæ•è·å¼‚å¸¸"><a href="#å¼‚å¸¸æ­»äº¡-vs-æœªæ•è·å¼‚å¸¸" class="header-anchor">#</a> å¼‚å¸¸æ­»äº¡ vs. æœªæ•è·å¼‚å¸¸</h1> <p>åœ¨Nodeä¸­ä½ å¯ä»¥å†™ä¸€ä¸ªå…¨å±€çš„å¥æŸ„æ¥å¤„ç†æ‰€æœ‰æœªæ•è·çš„å¼‚å¸¸</p> <blockquote><p>process.on(â€˜uncaughtExceptionâ€™, function (err) {</p> <p>console.log(â€˜ignoringâ€¦â€™);</p> <p>})</p></blockquote> <p>åœ¨Denoæ—¶ï¼Œå¦‚æœæœ‰æœªæ•è·å¼‚å¸¸ï¼Œç¨‹åºå°±ä¼šæ­»æ‰ã€‚è¿™ä¸ªå†³ç­–å¾ˆé‡è¦ã€‚
æ·±å…¥çš„çœ‹ä¸€ä¸‹Denoçš„ä¸€äº›ç‰¹æ€§ï¼š</p> <h1 id="æ¨¡å—å’ŒåŒ…ç®¡ç†"><a href="#æ¨¡å—å’ŒåŒ…ç®¡ç†" class="header-anchor">#</a> æ¨¡å—å’ŒåŒ…ç®¡ç†</h1> <p>Denoé€šè¿‡URLå¼•å…¥æ¨¡å—ï¼Œè¿™å°±ä¸éœ€è¦ <strong>package.json</strong> å’Œ <strong>node_modules</strong>ã€‚è¿™å°±æ„å‘³ç€ï¼Œæ²¡æœ‰ç¼“å­˜äº†ï¼Œä½ åªç”¨ä¸‹è½½ä¸€æ¬¡åŒ…å’Œæ¨¡å—ã€‚æ¯”å¦‚ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>import { assertEquals } from &quot;https://deno.land/std@0.93.0/testing/asserts.ts&quot;;
assertEquals(2 + 2, 5);
console.log('success!')
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸º2+2ç­‰äº4ï¼Œè¿™ä¸ªç¨‹åºä¼šå‡ºé”™ã€‚Denoä¹Ÿæ˜¯è¿™ä¹ˆè®¤ä¸ºçš„</p> <blockquote><p>$ deno run ./assert.ts</p> <p>error: Uncaught AssertionError: Values are not equal:</p> <p>[Diff] Actual / Expected</p> <ul><li>4</li></ul> <ul><li>5</li></ul> <p>throw new AssertionError(message);</p> <p>^</p> <p>at assertEquals (https://deno.land/std@0.93.0/testing/asserts.ts:219:9)</p> <p>at file:///Users/gigi.sayfan/git/deno_test/assert.ts:3:1</p></blockquote> <p>æ”¹ä¸€ä¸‹</p> <div class="language- extra-class"><pre class="language-text"><code>import { assertEquals } from &quot;https://deno.land/std@0.93.0/testing/asserts.ts&quot;;
assertEquals(2 + 2, 4);
console.log('success!')
</code></pre></div><p>ow, it succeeds:</p> <blockquote><p>$ deno run ./assert.ts</p> <p>Check file:///Users/gigi.sayfan/git/deno_test/assert.ts</p> <p>success!</p></blockquote> <p>OKäº†ã€‚
çœ‹ä¸€ä¸‹åŒ…å’Œå¯¼å…¥</p> <blockquote><p>import { assertEquals } from â€œhttps://deno.land/std@0.93.0/testing/asserts.ts&quot;;</p></blockquote> <p>è¿™é‡Œé€šè¿‡URLå¯¼å…¥äº†ä¸€ä¸ª<strong>assertEquals</strong> symbolï¼Œè¿™æ˜¯åœ¨Denoæ ‡å‡†åº“ä¸­åšçš„äº‹æƒ…ã€‚
æ³¨æ„URLä¸­åŒ…å«äº†ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ‰€ä»¥è‡ªç„¶æ”¯æŒåŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬ã€‚</p> <p>Denoç»´æŠ¤äº†ä¸€ä¸ªè§„åˆ’ä¸­çš„åŒ…åˆ—è¡¨<a href="https://deno.land/" target="_blank" rel="noopener noreferrer">https://deno.land<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  ä½†ä½ å¯ä»¥ä»ä»»ä½•urlä¸­å¯¼å…¥åŒ…</p> <p>å¯ä»¥å°è¯•ç€ä»GitHubçš„URLä¸Šå¯¼å…¥ä¸€ä¸ªåŒ…</p> <blockquote><p>import { assertEquals } from â€œhttps://raw.githubusercontent.com/denoland/deno_std/main/testing/asserts.ts&quot;</p></blockquote> <h1 id="å¼‚æ­¥æ”¯æŒ"><a href="#å¼‚æ­¥æ”¯æŒ" class="header-anchor">#</a> å¼‚æ­¥æ”¯æŒ</h1> <p>Denoçš„å¼‚æ­¥APIä¼šè¿”å›promise.è¿™æ ·ä½ å¯ä»¥è¿è¡Œä½ çš„å¼‚æ­¥æ“ä½œï¼Œç„¶åawaitç»“æœï¼Œè€Œä¸ç”¨å»å¤„ç†ä¸€å›¢ä¹±éº»çš„å›è°ƒå‡½æ•°</p> <p>æ¯”å¦‚:</p> <div class="language- extra-class"><pre class="language-text"><code>const promise = Deno.run({cmd: ['deno', 'eval', 'console.log(2+3)']})
await promise.status()

/*

Output:
5

*/
</code></pre></div><p>æˆ‘ä»¬ä½¿ç”¨ <strong>Deno.run()</strong> è¿è¡Œäº†ä¸€ä¸ªå­è¿›ç¨‹ã€‚å­è¿›ç¨‹æ˜¯å¦ä¸€ä¸ªDenoçš„å®ä¾‹ï¼Œç„¶åæˆ‘ä»¬ä¼ é€’äº†è¡¨è¾¾å¼<strong>console.log(2+3)</strong> ï¼Œå®ƒä¼šåœ¨æ§åˆ¶å°è¾“å‡º5</p> <p>å¯¹äºè¿è¡Œæ—¶é—´æ¯”è¾ƒé•¿çš„ä»»åŠ¡ï¼Œä¸ºäº†ä¸é˜»å¡å½“å‰çº¿ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨await <strong>promise.status()</strong></p> <h1 id="deno-å’Œ-ts"><a href="#deno-å’Œ-ts" class="header-anchor">#</a> Deno å’Œ TS</h1> <p>Denoå†…ç½®äº†å¯¹TSçš„æ”¯æŒï¼Œè¿™æ ·ä½ å°±ä¸éœ€è¦å·¥å…·é“¾æ¥è¿›è¡Œç¼–è¯‘äº†ã€‚Denoè‡ªå¸¦äº†ä¸€ä¸ªTSçš„ç¼–è¯‘å™¨ï¼Œå¹¶æŠŠè½¬æ¢åçš„TSæ¨¡å—æ”¾åœ¨ç¼“å­˜ä¸­ã€‚å½“TSæ–‡ä»¶æ”¹åŠ¨æ—¶ï¼Œä¼šè¢«é‡æ–°ç¼–è¯‘ä¸€ä¸‹ï¼Œä¿æŒæ›´æ–°ã€‚
æŸ¥çœ‹ç¼“å­˜ä½ç½®ï¼Œå’Œå·²æœ‰çš„æ¨¡å—ä¿¡æ¯ï¼š</p> <blockquote><p>$ deno info</p> <p>DENO_DIR location: â€œ/Users/gigi.sayfan/Library/Caches/denoâ€</p> <p>Remote modules cache: â€œ/Users/gigi.sayfan/Library/Caches/deno/depsâ€</p> <p>Emitted modules cache: â€œ/Users/gigi.sayfan/Library/Caches/deno/genâ€</p> <p>Language server registries cache: â€œ/Users/gigi.sayfan/Library/Caches/deno/registriesâ€</p></blockquote> <h1 id="å®‰å…¨"><a href="#å®‰å…¨" class="header-anchor">#</a> å®‰å…¨</h1> <p>Denoè‡ªä¸‹è€Œä¸Šçš„ä¿è¯å®‰å…¨ï¼Œæ§åˆ¶ç”¨æˆ·å¯ä»¥è®¿é—®çš„æƒé™ã€‚
ç½‘ç»œï¼Œç¯å¢ƒï¼Œæ–‡ä»¶ç³»ç»Ÿé»˜è®¤æ˜¯ä¸å¯è®¿é—®çš„èµ„æºã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å°è¯•å†™ä¸€ä¸ªæ–‡ä»¶ï¼š</p> <p>å‡å¦‚ä»£ç æ”¾åœ¨ <strong>write_file.ts</strong>ä¸­.</p> <div class="language- extra-class"><pre class="language-text"><code>Deno.writeTextFileSync('data.txt', 'some data')
</code></pre></div><p>è¿è¡Œä¸€ä¸‹:</p> <blockquote><p>$ deno run write_file.ts</p> <p>Check file:///Users/gigi.sayfan/git/deno_test/write_file.ts</p> <p>error: Uncaught PermissionDenied: Requires write access to â€œ1.txtâ€, run again with the â€” allow-write flag</p> <p>Deno.writeTextFileSync(â€˜data.txtâ€™, â€˜some dataâ€™)</p> <p>^</p> <p>at unwrapOpResult (deno:core/core.jsğŸ’¯13)</p> <p>at Object.opSync (deno:core/core.js:114:12)</p> <p>at openSync (deno:runtime/js/40_files.js:32:22)</p> <p>at writeFileSync (deno:runtime/js/40_write_file.js:24:18)</p> <p>at Object.writeTextFileSync (deno:runtime/js/40_write_file.js:82:12)</p> <p>at file:///Users/gigi.sayfan/git/deno_test/write_file.ts:1:6</p></blockquote> <p>æŠ›å‡ºä¸€ä¸ªæƒé™é”™è¯¯ï¼Œå‘Šè¯‰æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªflagå€¼ã€‚ç„¶åæˆ‘ä»¬é‡æ–°è¿è¡Œä¸€ä¸‹ï¼š</p> <blockquote><p>$ deno run â€” allow-write write_file.ts</p> <p>Check file:///Users/gigi.sayfan/git/deno_test/write_file.ts</p> <p>$ cat data.txt</p> <p>some data</p></blockquote> <p>ç°åœ¨å¯ä»¥äº†ã€‚å› æ­¤ï¼Œè¦å°å¿ƒè¿è¡Œä½ çš„Denoä»£ç ã€‚</p> <h1 id="å·¥å…·"><a href="#å·¥å…·" class="header-anchor">#</a> å·¥å…·</h1> <p>Denoå¾ˆæ³¨é‡å¼€å‘è€…ä½“éªŒï¼Œæ‰€ä»¥æä¾›äº†å¾ˆå¤šå·¥å…·ã€‚çœ‹çœ‹æœ‰å“ªäº›ï¼š</p> <h1 id="æ ¼å¼åŒ–"><a href="#æ ¼å¼åŒ–" class="header-anchor">#</a> æ ¼å¼åŒ–</h1> <p>å‡å¦‚æœ‰æ–‡ä»¶ <strong>fmt-test.ts</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>function foo()
{
    console.log('foo here')
  const x    = 3
         console.log('x + 2 =', x+2)
}

foo()
</code></pre></div><p>å®ƒæ˜¯TSçš„ï¼Œä½†æ˜¯ä»£ç å†™çš„å¾ˆä¹±</p> <p>æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ <strong>deno fmt</strong>:</p> <blockquote><p>$ cat fmt_test.ts | deno fmt -</p></blockquote> <p>æˆ‘ä»¬ä¼šå¾—åˆ°:</p> <div class="language- extra-class"><pre class="language-text"><code>function foo() {
  console.log(&quot;foo here&quot;);
  const x = 3;
  console.log(&quot;x + 2 =&quot;, x + 2);
}

foo();
</code></pre></div><p>æ•ˆæœä¸é”™</p> <h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="header-anchor">#</a> æµ‹è¯•</h1> <p>æµ‹è¯•çš„é‡è¦æ€§æ— å®¹ç½®ç–‘ï¼ŒDenoä¸éœ€è¦å€Ÿç”¨ç¬¬ä¸‰æ–¹çš„æ¡†æ¶ï¼Œåªè¦ä½¿ç”¨è‡ªå·±çš„æ–­è¨€æ¨¡å—å°±å¯ä»¥ã€‚</p> <p>æˆ‘ä»¬å†æ–‡ä»¶<strong>test-test.ts</strong>ä¸­å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°<strong>is_palindrome()</strong> ï¼Œç”¨æ¥æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦å›æ–‡ï¼Œç„¶ååŠ ä¸€äº›æµ‹è¯•ã€‚å‰ä¸¤å“¥æµ‹è¯•åº”è¯¥é€šè¿‡ï¼Œè€Œç¬¬ä¸‰ä¸ªåº”è¯¥å¤±è´¥ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>import { assert } from &quot;https://deno.land/std@0.95.0/testing/asserts.ts&quot;;

function is_palindrome(s: string) {
  const ss = s.replaceAll(' ', '')
  const a = ss.split('')
  return a.reverse().join('') == ss
} 

await Deno.test(&quot;Palindrome 1 - success&quot;, () =&gt; {
  assert(is_palindrome(&quot;tattarrattat&quot;));
})

await Deno.test(&quot;Palindrome 2 - success&quot;, () =&gt; {
  assert(is_palindrome(&quot;never odd or even&quot;));
})

await Deno.test(&quot;Palindrome 3 - fail&quot;, () =&gt; {
  assert(is_palindrome(&quot;this is not a palindrom&quot;), &quot;fail!&quot;)
})
</code></pre></div><p>è¿è¡Œ <strong>deno test</strong> å‘½ä»¤:</p> <blockquote><p>$ deno test test_test.ts</p> <p>Check file:///Users/gigi.sayfan/git/deno_test/$deno$test.ts</p> <p>running 3 tests</p> <p>test Palindrome 1 â€” success â€¦ ok (1ms)</p> <p>test Palindrome 2 â€” success â€¦ ok (1ms)</p> <p>test Palindrome 3 â€” fail â€¦ FAILED (2ms)</p> <p>failures:</p> <p>Palindrome 3 â€” fail</p> <p>AssertionError: fail!</p> <p>at assert (https://deno.land/std@0.95.0/testing/asserts.ts:178:11)</p> <p>at file:///Users/gigi.sayfan/git/deno_test/test_test.ts:19:3</p> <p>at asyncOpSanitizer (deno:runtime/js/40_testing.js:37:15)</p> <p>at resourceSanitizer (deno:runtime/js/40_testing.js:73:13)</p> <p>at Object.exitSanitizer [as fn] (deno:runtime/js/40_testing.jsğŸ’¯15)</p> <p>at TestRunner.[Symbol.asyncIterator] (deno:runtime/js/40_testing.js:272:24)</p> <p>at AsyncGenerator.next (<anonymous>)
at Object.runTests (deno:runtime/js/40_testing.js:347:22)</anonymous></p> <p>at async file:///Users/gigi.sayfan/git/deno_test/$deno$test.ts:3:1</p> <p>failures:</p> <p>Palindrome 3 â€” fail</p> <p>test result: FAILED. 2 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out (4ms)</p></blockquote> <h1 id="æ„å»º"><a href="#æ„å»º" class="header-anchor">#</a> æ„å»º</h1> <p>æ„å»ºå¯ä»¥è®©æ‰€æœ‰çš„åŒ…é›†æˆåœ¨ä¸€ä¸ªbundleä¸­ã€‚Denoæä¾›äº†<strong>bundle</strong>å‘½ä»¤ã€‚
å‡å¦‚<strong>foobar.ts</strong> æ¨¡å—ä» <strong>foo.ts</strong>ä¸­å¼•å…¥äº† **foo()<strong>å‡½æ•°ï¼Œä»</strong>bar.ts.<strong>ä¸­å¼•å…¥äº†</strong>bar()**å‡½æ•°</p> <p><strong>foo.ts</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>export function foo() {
    console.log('foo')
}
</code></pre></div><p><strong>bar.ts</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>export function bar() {

 console.log('bar') 
}
</code></pre></div><p><strong>foobar.ts</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>import { foo } from &quot;./foo.ts&quot;
import { bar } from &quot;./bar.ts&quot;

foo()
bar()
</code></pre></div><p>Letâ€™s bundle them all up into a single file:</p> <blockquote><p>$ deno bundle foobar.ts</p> <p>Bundle file:///Users/gigi.sayfan/git/deno_test/foobar.ts</p> <p>Check file:///Users/gigi.sayfan/git/deno_test/foobar.ts</p></blockquote> <p>Here is the result:</p> <div class="language- extra-class"><pre class="language-text"><code>function foo() {
    console.log('foo');
}
function bar() {
    console.log('bar');
}
foo();
bar();
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œimportå£°æ˜å·²ç»ä¸è§äº†ï¼Œ<strong>foo()</strong>  å’Œ <strong>bar()</strong> è¢«ç›´æ¥åµŒå…¥åˆ°ä¸€ä¸ªbundleæ–‡ä»¶ä¸­äº†ã€‚</p> <h1 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="header-anchor">#</a> è°ƒè¯•</h1> <p>è¿è¡Œæ—¶ä½¿ç”¨ <strong>â€” inspect</strong> æˆ–è€…**â€” inspect-brk** æ ‡è®°ï¼Œå°±å¯ä»¥ä½¿ç”¨Chrome DevToolæ¥è¿›è¡Œè°ƒè¯•ã€‚ä¸ªäººæ¨èä½¿ç”¨ JetBrains IDEs å’Œä¸€äº›denoæ’ä»¶ã€‚
å¦‚æœä½¿ç”¨VSCodeï¼Œå°±éœ€è¦æ‰‹åŠ¨é…ç½®ä¸€ä¸‹<strong>launch.json</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;version&quot;: &quot;0.2.0&quot;,
  &quot;configurations&quot;: [
    {
      &quot;name&quot;: &quot;Deno&quot;,
      &quot;type&quot;: &quot;pwa-node&quot;,
      &quot;request&quot;: &quot;launch&quot;,
      &quot;cwd&quot;: &quot;${workspaceFolder}&quot;,
      &quot;runtimeExecutable&quot;: &quot;deno&quot;,
      &quot;runtimeArgs&quot;: [&quot;run&quot;, &quot;--inspect-brk&quot;, &quot;-A&quot;, &quot;${file}&quot;],
      &quot;attachSimplePort&quot;: 9229
    }
  ]
}
</code></pre></div><h1 id="è„šæœ¬å®‰è£…"><a href="#è„šæœ¬å®‰è£…" class="header-anchor">#</a> è„šæœ¬å®‰è£…</h1> <p>ä½¿ç”¨å‘½ä»¤è¡Œç»å¸¸ä¼šè¦ä¼ é€’å¾ˆå¤šé¢å¤–çš„å‚æ•°ï¼Œä¸å¤ªæ–¹ä¾¿ã€‚ä½ å¯ä»¥ä½¿ç”¨ <strong>deno install</strong>æ¥åšä¸€äº›å¯åŠ¨è„šæœ¬ï¼ŒæŠŠè¿™ä¸ªè„šæœ¬æ”¾åœ¨ä½ æƒ³æ”¾çš„ä½ç½®ï¼Œæˆ–è€…**$HOME/.deno/bin**
æˆ‘ä»¬å®‰è£…ä¸€ä¸ªfoobar</p> <blockquote><p>$ deno install foobar.ts</p> <p>âœ… Successfully installed foobar</p> <p>/Users/gigi.sayfan/.deno/bin/foobar</p> <p>â„¹ï¸ Add /Users/gigi.sayfan/.deno/bin to PATH</p> <p>export PATH=â€/Users/gigi.sayfan/.deno/bin:$PATHâ€</p></blockquote> <p>æˆ‘åœ¨PATHç¯å¢ƒå˜é‡ä¸­å¢åŠ äº†**$HOME/.deno/bin**ã€‚è¿™æ ·æˆ‘å¯ä»¥åœ¨ä»»æ„ä½ç½®æ‰§è¡Œ<strong>foobar</strong>ï¼Œè¿è¡Œè„šæœ¬</p> <blockquote><p>$ cd /tmp</p> <p>$ foobar</p> <p>foo</p> <p>bar</p></blockquote> <h1 id="deno-æœºåˆ¶"><a href="#deno-æœºåˆ¶" class="header-anchor">#</a> Deno æœºåˆ¶</h1> <p>Denoæ˜¯åŸºäºRustå’ŒTypeScriptæ¥å®ç°çš„ã€‚ä¸»è¦çš„ç»„ä»¶æœ‰è¿™äº›ï¼š</p> <ul><li>deno</li> <li>deno_core</li> <li>tsc</li> <li>swc</li> <li>rusty_v8
[deno]åˆ›å»ºäº†å¯æ‰§è¡Œçš„denoï¼Œæˆ‘ä»¬ä¸ä¹‹äº¤äº’ã€‚
[deno_core]åˆ›å»ºJSè¿è¡Œæ—¶ã€‚Denoä½¿ç”¨äº† <a href="https://lib.rs/crates/tokio" target="_blank" rel="noopener noreferrer">Tokio<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥å®ç°å¼‚æ­¥äº‹ä»¶å¾ªç¯ã€‚
<a href="https://www.typescriptlang.org/docs/handbook/2/basic-types.html#tsc-the-typescript-compiler" target="_blank" rel="noopener noreferrer">tsc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ˜¯ä¸€ä¸ªTSçš„æ ‡å‡†ç¼–è¯‘å™¨ã€‚ä¹Ÿç”¨æ¥åšç±»å‹æ£€æŸ¥ã€‚
<a href="https://swc.rs/" target="_blank" rel="noopener noreferrer">swc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ç”¨æ¥åŠ é€ŸWebç¼–è¯‘ï¼Œç°åœ¨ä¸»è¦ç¼–è¯‘ä½ çš„JSå’ŒTSä»£ç ã€‚
[rustry_v8]åˆ™ä½¿ç”¨Rustä¸V8çš„C++ APIç»‘å®šã€‚</li></ul> <h1 id="ç»¼è¿°"><a href="#ç»¼è¿°" class="header-anchor">#</a> ç»¼è¿°</h1> <p>Denoå¾ˆå¹´è½»ï¼Œä½†æ˜¯ä¸å¯å°è§‘ã€‚å®ƒåŸºäºNodeçš„ç»éªŒå’Œæ•™è®­æ¥è®¾è®¡çš„ã€‚å®ƒçš„æŠ€æœ¯æå‡è¿œè¿œè¶…è¿‡äº†Node,å¹¶ä¸”ä½¿ç”¨äº†æ›´åŠ ç°ä»£çš„æŠ€æœ¯æ ˆã€‚æœ€å¤§çš„é—®é¢˜æ˜¯å®ƒä¼šä¸ä¼šåœ¨æˆä¸ºJSå’ŒTSçš„åå°è¿è¡Œæ—¶ã€‚ç°åœ¨è¯´è¿˜ä¸ºæ—¶å°šæ—©ï¼Œä½†æ˜¯å¦‚æœçœŸçš„è¿™æ ·ï¼Œæˆ‘è¿˜æ˜¯å¾ˆæœŸå¾…çš„ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/feblog/howjswork/26.html" class="prev">
        26.å¤šæ€çš„3ç§ç±»å‹
      </a></span> <span class="next"><a href="/feblog/howjswork/29.html">
        29.JSè®¾è®¡æ¨¡å¼
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/feblog/assets/js/app.af16a26a.js" defer></script><script src="/feblog/assets/js/2.bb248851.js" defer></script><script src="/feblog/assets/js/31.3494180c.js" defer></script>
  </body>
</html>
